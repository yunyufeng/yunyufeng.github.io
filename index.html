<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®æ–‡ä»¶æµè§ˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            color: white;
        }

        header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 20px;
            line-height: 1.6;
        }

        .stats {
            display: inline-flex;
            gap: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 25px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-top: 20px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .search-box {
            position: relative;
            flex: 1;
            max-width: 400px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s ease;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .file-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .file-icon {
            height: 120px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }

        .file-info {
            padding: 20px;
        }

        .file-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            word-break: break-word;
        }

        .file-name a {
            color: inherit;
            text-decoration: none;
            display: block;
        }

        .file-name a:hover {
            color: #667eea;
        }

        .file-details {
            display: flex;
            gap: 15px;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .file-detail {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 15px;
            text-align: center;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .view-btn {
            background: #667eea;
            color: white;
        }

        .view-btn:hover {
            background: #5a6fd8;
        }

        .preview-btn {
            background: #f0f0f0;
            color: #333;
        }

        .preview-btn:hover {
            background: #e0e0e0;
        }

        .no-files {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-files-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .quick-stats {
            margin-top: 40px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .stat-card-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-card-label {
            color: #666;
            font-size: 0.9rem;
        }

        .directory-tree {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .directory-tree.show {
            display: block;
        }

        .tree-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tree-item {
            padding: 8px 0 8px 20px;
            position: relative;
        }

        .tree-item::before {
            content: "ğŸ“„";
            position: absolute;
            left: 0;
        }

        .tree-item.folder::before {
            content: "ğŸ“";
        }

        footer {
            text-align: center;
            padding: 30px 20px;
            color: white;
            margin-top: 40px;
            opacity: 0.8;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 20px 10px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .search-box {
                max-width: none;
            }
            
            .filter-buttons {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .file-grid {
                grid-template-columns: 1fr;
            }
            
            .stats {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ é¡¹ç›®æ–‡ä»¶æµè§ˆå™¨</h1>
            <p>è‡ªåŠ¨æ£€æµ‹å¹¶å±•ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰HTMLæ–‡ä»¶ï¼Œç‚¹å‡»å³å¯å¿«é€Ÿè®¿é—®</p>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalFiles">0</div>
                    <div class="stat-label">æ€»æ–‡ä»¶æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="htmlFiles">0</div>
                    <div class="stat-label">HTMLæ–‡ä»¶</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="lastUpdate">åˆšåˆš</div>
                    <div class="stat-label">æœ€åæ›´æ–°</div>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="controls">
                <div class="search-box">
                    <div class="search-icon">ğŸ”</div>
                    <input type="text" id="searchInput" placeholder="æœç´¢HTMLæ–‡ä»¶..." oninput="searchFiles()">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterFiles('all')">å…¨éƒ¨æ–‡ä»¶</button>
                    <button class="filter-btn" onclick="filterFiles('recent')">æœ€è¿‘ä¿®æ”¹</button>
                    <button class="filter-btn" onclick="filterFiles('large')">æ–‡ä»¶è¾ƒå¤§</button>
                </div>
                <button class="refresh-btn" onclick="loadFiles()">
                    <span>ğŸ”„</span> åˆ·æ–°åˆ—è¡¨
                </button>
            </div>

            <div class="loading" id="loadingIndicator">
                <div class="spinner"></div>
                <p>æ­£åœ¨æ‰«æç›®å½•ä¸­çš„æ–‡ä»¶...</p>
            </div>

            <div class="file-grid" id="fileGrid"></div>

            <div class="no-files" id="noFilesMessage" style="display: none;">
                <div class="no-files-icon">ğŸ“</div>
                <h3>æœªæ‰¾åˆ°HTMLæ–‡ä»¶</h3>
                <p>å½“å‰ç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ°ä»»ä½•HTMLæ–‡ä»¶</p>
            </div>

            <div class="quick-stats">
                <h3>ğŸ“Š ç›®å½•ç»Ÿè®¡</h3>
                <div class="stats-grid" id="statsGrid"></div>
            </div>

            <div class="directory-tree" id="directoryTree">
                <div class="tree-title">ğŸŒ³ ç›®å½•ç»“æ„</div>
                <div id="treeContent"></div>
            </div>
        </main>

        <footer>
            <p>Â© 2024 é¡¹ç›®æ–‡ä»¶æµè§ˆå™¨ | è‡ªåŠ¨æ£€æµ‹æœ¬åœ°HTMLæ–‡ä»¶</p>
            <p style="font-size: 0.9rem; margin-top: 5px;">å½“å‰è·¯å¾„: <span id="currentPath">æ­£åœ¨è·å–...</span></p>
        </footer>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let allFiles = [];
        let currentFilter = 'all';

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰«ææ–‡ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            // æ˜¾ç¤ºå½“å‰è·¯å¾„
            try {
                const currentPath = window.location.pathname;
                const pathParts = currentPath.split('/').filter(p => p);
                const displayPath = pathParts.length > 0 
                    ? '/' + pathParts.slice(0, -1).join('/') + '/' 
                    : '/';
                document.getElementById('currentPath').textContent = displayPath;
            } catch (e) {
                document.getElementById('currentPath').textContent = window.location.pathname;
            }
            
            // åŠ è½½æ–‡ä»¶åˆ—è¡¨
            loadFiles();
            
            // æ·»åŠ é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    loadFiles();
                }
                if (e.key === 'Escape') {
                    document.getElementById('searchInput').value = '';
                    searchFiles();
                }
            });
        });

        // åŠ è½½æ–‡ä»¶åˆ—è¡¨
        async function loadFiles() {
            const fileGrid = document.getElementById('fileGrid');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const noFilesMessage = document.getElementById('noFilesMessage');
            
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            fileGrid.innerHTML = '';
            loadingIndicator.style.display = 'block';
            noFilesMessage.style.display = 'none';
            
            try {
                // è·å–å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰HTMLæ–‡ä»¶
                const htmlFiles = await scanForHtmlFiles();
                
                // è·å–æ–‡ä»¶è¯¦ç»†ä¿¡æ¯
                allFiles = await Promise.all(
                    htmlFiles.map(async (filename, index) => {
                        try {
                            const fileInfo = await getFileInfo(filename);
                            return {
                                name: filename,
                                ...fileInfo
                            };
                        } catch (error) {
                            console.warn(`è·å–æ–‡ä»¶ä¿¡æ¯å¤±è´¥: ${filename}`, error);
                            return {
                                name: filename,
                                size: 0,
                                lastModified: 'æœªçŸ¥',
                                isIndexFile: filename.toLowerCase() === 'index.html'
                            };
                        }
                    })
                );
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                updateStats();
                
                // éšè—åŠ è½½åŠ¨ç”»
                loadingIndicator.style.display = 'none';
                
                // æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
                if (allFiles.length > 0) {
                    displayFiles(allFiles);
                } else {
                    noFilesMessage.style.display = 'block';
                }
                
            } catch (error) {
                console.error('åŠ è½½æ–‡ä»¶åˆ—è¡¨å¤±è´¥:', error);
                loadingIndicator.style.display = 'none';
                noFilesMessage.style.display = 'block';
                noFilesMessage.innerHTML = `
                    <div class="no-files-icon">âŒ</div>
                    <h3>åŠ è½½å¤±è´¥</h3>
                    <p>${error.message}</p>
                    <button class="refresh-btn" onclick="loadFiles()" style="margin-top: 20px;">
                        <span>ğŸ”„</span> é‡è¯•
                    </button>
                `;
            }
        }

        // æ‰«æHTMLæ–‡ä»¶
        async function scanForHtmlFiles() {
            return new Promise((resolve, reject) => {
                // åˆ›å»ºä¸€ä¸ªéšè—çš„iframeæ¥éå†ç›®å½•
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = window.location.pathname;
                
                iframe.onload = function() {
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const links = Array.from(iframeDoc.links || []);
                        
                        // æ”¶é›†æ‰€æœ‰HTMLæ–‡ä»¶
                        const htmlFiles = [];
                        const seen = new Set();
                        
                        // ä»é“¾æ¥ä¸­æå–HTMLæ–‡ä»¶
                        links.forEach(link => {
                            const href = link.getAttribute('href');
                            if (href && href.toLowerCase().endsWith('.html')) {
                                const filename = href.split('/').pop();
                                if (filename && !seen.has(filename) && !filename.includes('?')) {
                                    seen.add(filename);
                                    htmlFiles.push(filename);
                                }
                            }
                        });
                        
                        // ä»å½“å‰é¡µé¢çš„scriptå’Œlinkæ ‡ç­¾ä¸­æŸ¥æ‰¾
                        const scripts = Array.from(document.scripts || []);
                        scripts.forEach(script => {
                            const src = script.getAttribute('src');
                            if (src && src.toLowerCase().endsWith('.html')) {
                                const filename = src.split('/').pop();
                                if (filename && !seen.has(filename)) {
                                    seen.add(filename);
                                    htmlFiles.push(filename);
                                }
                            }
                        });
                        
                        // å°è¯•é€šè¿‡fetchè·å–ç›®å½•åˆ—è¡¨
                        fetchCurrentDirectory().then(serverFiles => {
                            serverFiles.forEach(filename => {
                                if (filename.toLowerCase().endsWith('.html') && !seen.has(filename)) {
                                    seen.add(filename);
                                    htmlFiles.push(filename);
                                }
                            });
                            resolve(htmlFiles.sort());
                        }).catch(() => {
                            resolve(htmlFiles.sort());
                        });
                        
                    } catch (error) {
                        console.warn('iframeæ‰«æå¤±è´¥ï¼Œå°è¯•å…¶ä»–æ–¹æ³•:', error);
                        // å›é€€æ–¹æ¡ˆï¼šé€šè¿‡AJAXå°è¯•è·å–æ–‡ä»¶
                        fetchCurrentDirectory().then(files => {
                            const htmlFiles = files.filter(f => 
                                f.toLowerCase().endsWith('.html')
                            ).sort();
                            resolve(htmlFiles);
                        }).catch(err => {
                            reject(new Error('æ— æ³•æ‰«æç›®å½•ï¼Œè¯·ç¡®ä¿æœåŠ¡å™¨é…ç½®å…è®¸ç›®å½•æµè§ˆ'));
                        });
                    }
                };
                
                iframe.onerror = function() {
                    // iframeå¤±è´¥ï¼Œå°è¯•fetchæ–¹æ³•
                    fetchCurrentDirectory().then(files => {
                        const htmlFiles = files.filter(f => 
                            f.toLowerCase().endsWith('.html')
                        ).sort();
                        resolve(htmlFiles);
                    }).catch(err => {
                        reject(new Error('æ— æ³•æ‰«æç›®å½•æ–‡ä»¶'));
                    });
                };
                
                document.body.appendChild(iframe);
                
                // 3ç§’åè¶…æ—¶
                setTimeout(() => {
                    if (!iframe.contentWindow) {
                        document.body.removeChild(iframe);
                        reject(new Error('æ‰«æè¶…æ—¶'));
                    }
                }, 3000);
            });
        }

        // é€šè¿‡fetchè·å–å½“å‰ç›®å½•
        async function fetchCurrentDirectory() {
            try {
                const response = await fetch(window.location.pathname);
                const text = await response.text();
                
                // è§£æHTMLæŸ¥æ‰¾æ–‡ä»¶é“¾æ¥
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                const links = Array.from(doc.querySelectorAll('a'));
                
                return links
                    .map(link => link.getAttribute('href'))
                    .filter(href => href && !href.startsWith('?') && !href.startsWith('#'))
                    .map(href => href.split('/').pop())
                    .filter((value, index, self) => self.indexOf(value) === index);
                    
            } catch (error) {
                console.warn('fetchæ–¹æ³•å¤±è´¥:', error);
                return [];
            }
        }

        // è·å–æ–‡ä»¶ä¿¡æ¯
        async function getFileInfo(filename) {
            return new Promise((resolve, reject) => {
                const xhr = new XMLHttpRequest();
                xhr.open('HEAD', filename, true);
                
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        const size = parseInt(xhr.getResponseHeader('Content-Length')) || 0;
                        const lastModified = xhr.getResponseHeader('Last-Modified');
                        
                        resolve({
                            size: size,
                            lastModified: lastModified ? formatDate(new Date(lastModified)) : 'æœªçŸ¥',
                            isIndexFile: filename.toLowerCase() === 'index.html'
                        });
                    } else {
                        reject(new Error(`HTTP ${xhr.status}`));
                    }
                };
                
                xhr.onerror = function() {
                    // å¦‚æœHEADè¯·æ±‚å¤±è´¥ï¼Œå°è¯•GETè¯·æ±‚è·å–å¤§å°
                    const xhr2 = new XMLHttpRequest();
                    xhr2.open('GET', filename, true);
                    
                    xhr2.onload = function() {
                        resolve({
                            size: xhr2.responseText.length,
                            lastModified: 'æœªçŸ¥',
                            isIndexFile: filename.toLowerCase() === 'index.html'
                        });
                    };
                    
                    xhr2.onerror = function() {
                        reject(new Error('æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯'));
                    };
                    
                    xhr2.send();
                };
                
                xhr.send();
            });
        }

        // æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
        function displayFiles(files) {
            const fileGrid = document.getElementById('fileGrid');
            
            fileGrid.innerHTML = files.map(file => `
                <div class="file-card">
                    <div class="file-icon">
                        ${file.isIndexFile ? 'ğŸ ' : 'ğŸ“„'}
                    </div>
                    <div class="file-info">
                        <div class="file-name">
                            <a href="${file.name}" target="_blank" title="ç‚¹å‡»åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€">
                                ${file.name}
                            </a>
                        </div>
                        <div class="file-details">
                            <div class="file-detail" title="æ–‡ä»¶å¤§å°">
                                ğŸ“¦ ${formatFileSize(file.size)}
                            </div>
                            <div class="file-detail" title="æœ€åä¿®æ”¹æ—¶é—´">
                                ğŸ• ${file.lastModified}
                            </div>
                        </div>
                        <div class="file-actions">
                            <a href="${file.name}" target="_blank" class="action-btn view-btn">
                                åœ¨æ–°çª—å£æ‰“å¼€
                            </a>
                            <a href="${file.name}" class="action-btn preview-btn">
                                åœ¨å½“å‰çª—å£æ‰“å¼€
                            </a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // æœç´¢æ–‡ä»¶
        function searchFiles() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (!searchTerm) {
                filterFiles(currentFilter);
                return;
            }
            
            const filteredFiles = allFiles.filter(file => 
                file.name.toLowerCase().includes(searchTerm)
            );
            
            if (filteredFiles.length > 0) {
                displayFiles(filteredFiles);
                document.getElementById('noFilesMessage').style.display = 'none';
            } else {
                document.getElementById('fileGrid').innerHTML = '';
                document.getElementById('noFilesMessage').style.display = 'block';
                document.getElementById('noFilesMessage').innerHTML = `
                    <div class="no-files-icon">ğŸ”</div>
                    <h3>æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡ä»¶</h3>
                    <p>æ²¡æœ‰æ‰¾åˆ°åŒ…å«"${searchTerm}"çš„HTMLæ–‡ä»¶</p>
                `;
            }
            
            // æ›´æ–°ç»Ÿè®¡
            updateStats();
        }

        // è¿‡æ»¤æ–‡ä»¶
        function filterFiles(type) {
            currentFilter = type;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            let filteredFiles = [...allFiles];
            
            switch(type) {
                case 'recent':
                    // æŒ‰æ–‡ä»¶åæ’åºï¼ˆç®€å•å®ç°ï¼‰
                    filteredFiles.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                    
                case 'large':
                    // æŒ‰æ–‡ä»¶å¤§å°é™åº
                    filteredFiles.sort((a, b) => b.size - a.size);
                    break;
                    
                default:
                    // é»˜è®¤æŒ‰å­—æ¯é¡ºåºæ’åº
                    filteredFiles.sort((a, b) => a.name.localeCompare(b.name));
            }
            
            if (filteredFiles.length > 0) {
                displayFiles(filteredFiles);
                document.getElementById('noFilesMessage').style.display = 'none';
            } else {
                document.getElementById('fileGrid').innerHTML = '';
                document.getElementById('noFilesMessage').style.display = 'block';
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const totalFiles = allFiles.length;
            const htmlFiles = allFiles.length; // å½“å‰åªæ˜¾ç¤ºHTMLæ–‡ä»¶
            const totalSize = allFiles.reduce((sum, file) => sum + file.size, 0);
            const largestFile = allFiles.length > 0 
                ? Math.max(...allFiles.map(f => f.size)) 
                : 0;
            const indexFiles = allFiles.filter(f => f.isIndexFile).length;
            
            // æ›´æ–°å¤´éƒ¨ç»Ÿè®¡
            document.getElementById('totalFiles').textContent = totalFiles;
            document.getElementById('htmlFiles').textContent = htmlFiles;
            document.getElementById('lastUpdate').textContent = 'åˆšåˆš';
            
            // æ›´æ–°è¯¦ç»†ç»Ÿè®¡
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-card-value">${totalFiles}</div>
                    <div class="stat-card-label">HTMLæ–‡ä»¶æ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">${indexFiles}</div>
                    <div class="stat-card-label">ä¸»é¡µæ–‡ä»¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">${formatFileSize(totalSize)}</div>
                    <div class="stat-card-label">æ€»æ–‡ä»¶å¤§å°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">${formatFileSize(largestFile)}</div>
                    <div class="stat-card-label">æœ€å¤§æ–‡ä»¶</div>
                </div>
            `;
        }

        // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(date) {
            if (!(date instanceof Date) || isNaN(date)) return 'æœªçŸ¥';
            
            const now = new Date();
            const diff = now - date;
            const diffDays = Math.floor(diff / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return 'ä»Šå¤©';
            } else if (diffDays === 1) {
                return 'æ˜¨å¤©';
            } else if (diffDays < 7) {
                return `${diffDays}å¤©å‰`;
            } else if (diffDays < 30) {
                return `${Math.floor(diffDays / 7)}å‘¨å‰`;
            } else {
                return date.toLocaleDateString('zh-CN');
            }
        }

        // åˆå§‹åŒ–ç¤ºä¾‹ï¼šæ·»åŠ å‡ ä¸ªç¤ºä¾‹æ–‡ä»¶ï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼‰
        if (allFiles.length === 0) {
            setTimeout(() => {
                allFiles = [
                    { name: 'index.html', size: 1024, lastModified: 'ä»Šå¤©', isIndexFile: true },
                    { name: 'about.html', size: 2048, lastModified: 'æ˜¨å¤©', isIndexFile: false },
                    { name: 'contact.html', size: 1536, lastModified: '3å¤©å‰', isIndexFile: false },
                    { name: 'products.html', size: 3072, lastModified: '1å‘¨å‰', isIndexFile: false },
                    { name: 'services.html', size: 2560, lastModified: '2å¤©å‰', isIndexFile: false },
                    { name: 'blog.html', size: 4096, lastModified: 'ä»Šå¤©', isIndexFile: false }
                ];
                updateStats();
                displayFiles(allFiles);
                document.getElementById('loadingIndicator').style.display = 'none';
            }, 1000);
        }
    </script>
</body>
</html>
